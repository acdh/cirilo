<?xml version="1.0" encoding="utf-8"?>
<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">

	<map:components>

		<map:serializers>

			<map:serializer logger="sitemap.serializer.text" mime-type="text/plain" name="text"
				src="org.apache.cocoon.serialization.TextSerializer">
				<encoding>UTF-8</encoding>
			</map:serializer>
			
			<map:serializer name="xhtml" src="org.apache.cocoon.serialization.XMLSerializer"
				mime-type="text/html; charset=UTF-8">
				<doctype-system>http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd</doctype-system>
				<doctype-public>-//W3C//DTD XHTML 1.0 Strict//EN</doctype-public>
				<encoding>UTF-8</encoding>
				<indent>no</indent>
			</map:serializer>
			
			<map:serializer name="fo2pdf" src="org.apache.cocoon.serialization.FOPSerializer"
				mime-type="application/pdf">
				<user-config>/data/fonts/config.xml</user-config>
			</map:serializer>

		</map:serializers>

		<map:transformers default="xslt">

			<map:transformer name="xslt-saxon" pool-grow="2" pool-max="32" pool-min="8"
				src="org.apache.cocoon.transformation.TraxTransformer">
				<use-request-parameters>true</use-request-parameters>
				<use-browser-capabilities-db>false</use-browser-capabilities-db>
				<xslt-processor-role>saxon</xslt-processor-role>
				<encoding>UTF-8</encoding>
			</map:transformer>

			<map:transformer name="i18n" logger="sitemap.transformer.i18n"
				src="org.apache.cocoon.transformation.I18nTransformer">
				<catalogues default="messages">
					<catalogue id="messages" name="messages" location="i18n"/>
				</catalogues>
			</map:transformer>

		</map:transformers>

	</map:components>

	<map:pipelines>

		<map:pipeline>

			<map:match pattern="toHTML">
				<map:generate src="{request-param:source}"/>
				<map:transform type="xslt-saxon" src="{request-param:style}">
					<map:parameter name="locale" value="{request-param:locale}"/>
					<map:parameter name="model" value="{request-param:model}"/>
					<map:parameter name="mode" value="{request-param:mode}"/>
					<map:parameter name="context" value="{request-param:context}"/>
				</map:transform>
				<map:transform type="i18n">
					<map:parameter name="locale" value="{request-param:locale}"/>
				</map:transform>
				<map:serialize type="xhtml"/>
			</map:match>

			<map:match pattern="toXML">
				<map:generate src="{request-param:source}"/>
				<map:transform type="xslt" src="{request-param:style}">
					<map:parameter name="identifier" value="{request-param:identifier}"/>
				</map:transform>
				<map:serialize type="xml"/>
			</map:match>
			
			<map:match pattern="toPDF">
				<map:generate src="{request-param:source}"/>
				<map:transform type="xslt" src="{request-param:style}">
					<map:parameter name="locale" value="{request-param:locale}"/>
					<map:parameter name="mode" value="{request-param:mode}"/>
				</map:transform>
				<map:transform type="i18n">
					<map:parameter name="locale" value="{request-param:locale}"/>
				</map:transform>
				<map:serialize type="fo2pdf"/>
			</map:match>
						
			<map:match pattern="queryToHTML">
				<map:generate src="xsp/sparql.xsp" type="serverpages">
					<map:parameter name="query" value="{request-param:query}"/>
					<map:parameter name="params" value="{request-param:params}" />
				</map:generate>
				<map:transform type="xslt-saxon" src="styles/sesame2mulgara.xsl" />
				<map:transform type="xslt-saxon" src="{request-param:style}">
					<map:parameter name="locale" value="{request-param:locale}"/>
					<map:parameter name="model" value="{request-param:model}"/>
					<map:parameter name="mode" value="{request-param:mode}"/>
				</map:transform>
				<map:transform type="i18n">
					<map:parameter name="locale" value="{request-param:locale}"/>
				</map:transform>
				<map:serialize type="xhtml"/>
			</map:match>
						
                        	<map:match pattern="queryToXML">
				<map:generate src="xsp/sparql.xsp" type="serverpages">
					<map:parameter name="query" value="{request-param:query}"/>
					<map:parameter name="params" value="{request-param:params}" />
				</map:generate>
				<map:transform type="xslt-saxon" src="styles/sesame2mulgara.xsl" />
				<map:serialize type="xml"/>
			</map:match>
			
			<map:match pattern="dfgviewer">
				<map:redirect-to
					uri="http://dfg-viewer.de/show/?set[mets]={url-encode:{request-param:mets}}"/>
			</map:match>
			
			<map:match pattern="viewer">
				<map:redirect-to
					uri="http://gams.uni-graz.at/viewer/viewer.html?mets={url-encode:{request-param:mets}}"/>
			</map:match>
			
			<map:match pattern="toVoyant">
				<map:redirect-to
					uri="http://voyant-tools.org?input={url-encode:{request-param:input}}"/>
			</map:match>

			<map:match pattern="getSPARQL">
				<map:generate src="xsp/skos.xsp" type="serverpages">
					<map:parameter name="query" value="{request-param:query}"/>
					<map:parameter name="mode" value="getSPARQL"/>
				</map:generate>
				<map:transform type="xslt-saxon" src="styles/copy.xsl"/>
				<map:serialize type="xml"/>
			</map:match>

			<map:match pattern="getDC">
				<map:generate src="xsp/dc.xsp" type="serverpages">
					<map:parameter name="pid" value="{request-param:pid}"/>
				</map:generate>
				<map:transform type="xslt-saxon" src="styles/dc.xsl"/>
				<map:transform type="i18n">
					<map:parameter name="locale" value="{request-param:locale}"/>
				</map:transform>
				<map:serialize type="xhtml"/>
			</map:match>
						
			<map:match pattern="getConceptByURI">
				<map:generate src="xsp/skos.xsp" type="serverpages">
					<map:parameter name="uri" value="{request-param:uri}"/>
					<map:parameter name="mode" value="getConceptByURI"/>
				</map:generate>
				<map:transform type="xslt-saxon" src="styles/skos.xsl">
					<map:parameter name="mode" value="getConceptByURI"/>					
				</map:transform>
				<map:serialize type="xml"/>
			</map:match>

			<map:match pattern="getConceptByPrefLabel">
				<map:generate src="xsp/skos.xsp" type="serverpages">
					<map:parameter name="preflabel" value="{request-param:preflabel}"/>
					<map:parameter name="mode" value="getConceptByPrefLabel"/>
				</map:generate>
				<map:transform type="xslt-saxon" src="styles/skos.xsl">
					<map:parameter name="mode" value="getConceptByPrefLabel"/>					
				</map:transform>
				<map:serialize type="xml"/>
			</map:match>
			
			<map:match pattern="getConceptByExternalID">
				<map:generate src="xsp/skos.xsp" type="serverpages">
					<map:parameter name="externalid" value="{request-param:externalid}"/>
					<map:parameter name="mode" value="getConceptByExternalID"/>
				</map:generate>
				<map:transform type="xslt-saxon" src="styles/skos.xsl">
					<map:parameter name="mode" value="getConceptByExternalID"/>					
				</map:transform>
				<map:serialize type="xml"/>
			</map:match>
			
			<map:match pattern="getConceptRelatives">
				<map:generate src="xsp/skos.xsp" type="serverpages">
					<map:parameter name="uri" value="{request-param:uri}"/>
					<map:parameter name="relation" value="{request-param:relation}"/>
					<map:parameter name="mode" value="getConceptRelatives"/>
				</map:generate>
				<map:transform type="xslt-saxon" src="styles/skos.xsl">
					<map:parameter name="mode" value="getConceptRelatives"/>					
				</map:transform>
				<map:serialize type="xml"/>
			</map:match>
						
			<map:match pattern="BibTeX">
				<map:generate src="{request-param:source}"/>
				<map:transform type="xslt-saxon" src="styles/bibtex/{request-param:style}.xsl"/>
				<map:select type="request-parameter">
					<map:parameter name="parameter-name" value="style"/>
					<map:when test="MODS">
						<map:serialize type="xml"/>
					</map:when>
					<map:otherwise>
						<map:serialize type="text"/>
					</map:otherwise>
				</map:select>
			</map:match>

			<map:match pattern="filterMethods">
				<map:generate src="{request-param:methods}"/>
				<map:transform src="styles/filterMethods.xsl"/>
				<map:serialize type="xml"/>
			</map:match>
			
			<map:match pattern="openrdf-sesame">
				<map:generate src="http://gams.uni-graz.at/openrdf-sesame/repositories/gams.uni-graz.at.archive?query={url-encode:{request-param:query}}"/>
				<map:serialize type="xml"/>
			</map:match>			

			<map:match pattern="sparqlendpoint">
				<map:generate src="http://gams.uni-graz.at/archive/risearch?lang=sparql&amp;format=sparql&amp;query={url-encode:{request-param:query}}"/>
				<map:transform src="styles/mulgara2sesame.xsl"/>
				<map:serialize type="xml"/>
			</map:match>

			<map:match pattern="img/*.gif">
				<map:read src="img/{1}.gif" type="resource"/>
			</map:match>
			
			<map:match pattern="*.xsl">
				<map:read src="styles/{1}.xsl" type="resource"/>
			</map:match>
			
			<map:match pattern="img/*.png">
				<map:read src="img/{1}.png" type="resource"/>
			</map:match>

			<map:match pattern="css/*.css">
				<map:read src="css/{1}.css" type="resource"/>
			</map:match>


		</map:pipeline>

	</map:pipelines>


</map:sitemap>
